<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:citrus="http://www.citrusframework.org/schema/config"
	xmlns:citrus-http="http://www.citrusframework.org/schema/http/config"
	xmlns:citrus-test="http://www.citrusframework.org/schema/testcase"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
       http://www.citrusframework.org/schema/config http://www.citrusframework.org/schema/config/citrus-config.xsd
       http://www.citrusframework.org/schema/http/config http://www.citrusframework.org/schema/http/config/citrus-http-config.xsd
       http://www.citrusframework.org/schema/testcase http://www.citrusframework.org/schema/testcase/citrus-testcase.xsd">

	<citrus:global-variables>
		<citrus:variable name="project.name" value="Integration Tests for movie ws" />
		<citrus:variable name="endpoint.url" value="http://localhost:8080/moviews-web"/>
	</citrus:global-variables>

	<citrus-http:client id="moviewsclient"
		request-url="http://dummy" request-method="GET"
		content-type="application/json" timeout="60000" />
		
	<citrus:after-test id="cleanDBFromStoredData" test="*_LeavesDBDirty" package="se.face.moviews.integrationtest.tests">
		<citrus:actions>
        	<citrus-test:sql datasource="dataSource">
            	<citrus-test:statement>DELETE FROM cast_and_crew_in_movie where movieId=${savedMovieId}</citrus-test:statement>
            	<citrus-test:statement>DELETE cac FROM cast_and_crew_member cac left join cast_and_crew_in_movie cacim on cac.castAndCrewMemberId=cacim.castAndCrewMemberId where cacim.castAndCrewMemberId is null</citrus-test:statement>
            	<citrus-test:statement>DELETE FROM movie where movieId=${savedMovieId}</citrus-test:statement>
        	</citrus-test:sql>
    	</citrus:actions>
	</citrus:after-test>
</beans>
